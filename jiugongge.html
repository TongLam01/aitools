<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIé©¬å¹´ä¹å®«æ ¼å¤´åƒç”Ÿæˆå™¨ (Arkç‰ˆ)</title>
    <style>
        :root {
            --primary-red: #D93636;
            --gold: #F2C780;
            --bg-color: #FEF8F5;
        }
        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background-color: var(--bg-color);
            color: #333;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .container {
            max-width: 600px;
            width: 100%;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(217, 54, 54, 0.15);
            border: 2px solid var(--gold);
        }
        h1 {
            color: var(--primary-red);
            text-align: center;
            margin-bottom: 30px;
            font-weight: 800;
        }
        .config-section {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px dashed #ccc;
        }
        .config-section h3 { margin-top: 0; font-size: 14px; color: #666; }
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; font-size: 14px; }
        input[type="text"], input[type="password"] {
            width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box;
        }
        .upload-area {
            border: 2px dashed var(--primary-red);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 20px;
            background: #fff0f0;
        }
        .upload-area:hover { background: #ffe0e0; }
        #preview-img {
            max-width: 100%; max-height: 200px; border-radius: 8px; margin-top: 10px; display: none;
        }
        button {
            width: 100%; background-color: var(--primary-red); color: var(--gold);
            border: none; padding: 15px; font-size: 18px; font-weight: bold;
            border-radius: 8px; cursor: pointer; transition: background 0.3s;
        }
        button:hover { background-color: #b82525; }
        button:disabled { background-color: #ccc; cursor: not-allowed; }
        .result-area { margin-top: 30px; text-align: center; }
        #result-img { width: 100%; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .loading { display: none; color: var(--primary-red); font-weight: bold; margin-top: 10px; text-align: center;}
        .note { font-size: 12px; color: #888; margin-top: 10px; line-height: 1.5; }
        .error-msg { color: red; font-size: 14px; margin-top: 10px; display: none; word-break: break-all;}
    </style>
</head>
<body>

    <div class="container">
        <h1>ğŸ§§ é©¬å¹´ä¹å®«æ ¼ (Ark APIç‰ˆ)</h1>

        <div class="config-section">
            <h3>API é…ç½® (ç«å±±æ–¹èˆŸ Ark)</h3>
            <div class="input-group">
                <label>API Key (Bearer Token):</label>
                <input type="password" id="api-key" placeholder="è¾“å…¥ä½ çš„ API Key (ä¾‹å¦‚ c2121...)">
            </div>
            <div class="input-group">
                <label>Model ID (æ¨¡å‹åç§°):</label>
                <input type="text" id="model-id" value="doubao-seedream-4-5-251128" placeholder="è¾“å…¥æ¨¡å‹ID æˆ– Endpoint ID">
            </div>
            <div class="note">
                æ³¨æ„ï¼šè¯·ç¡®ä¿æµè§ˆå™¨å·²å®‰è£…å¹¶å¼€å¯ <b>Allow CORS</b> æ’ä»¶ï¼Œå¦åˆ™æµè§ˆå™¨ä¼šæ‹¦æˆªè¯·æ±‚ã€‚
            </div>
        </div>

        <div class="upload-area" onclick="document.getElementById('file-input').click()">
            <p>ğŸ“¸ ç‚¹å‡»ä¸Šä¼ ä¸ªäººç…§ç‰‡</p>
            <input type="file" id="file-input" accept="image/*" style="display: none" onchange="handleFileSelect(event)">
            <img id="preview-img" alt="é¢„è§ˆ">
        </div>

        <button id="generate-btn" onclick="generateImage()">âœ¨ ç”Ÿæˆæ–°å¹´ä¹å®«æ ¼ âœ¨</button>
        <div class="loading" id="loading-text">
            æ­£åœ¨è¯·æ±‚ Doubao-Seedream ç”Ÿæˆä¸­...<br>
            <small>(å¯èƒ½éœ€è¦ 10-20 ç§’)</small>
        </div>
        <div class="error-msg" id="error-msg"></div>

        <div class="result-area" id="result-area" style="display:none;">
            <h3>ç”Ÿæˆç»“æœï¼š</h3>
            <img id="result-img" alt="ç”Ÿæˆç»“æœ">
            <p style="font-size:12px; color:#666; margin-top:10px;">é•¿æŒ‰æˆ–å³é”®ä¿å­˜å›¾ç‰‡</p>
        </div>
    </div>

    <script>
        // === æ ¸å¿ƒæç¤ºè¯ ===
        const PROMPT_TEMPLATE = `ä¸€å¼ åŒ…å« 3x3 ä¹å®«æ ¼çŸ©é˜µçš„å•ç‰‡æ‘„å½±æ¥è§¦ç‰‡å›¾åƒï¼Œæ¯”ä¾‹ä¸º 1:1ã€‚

ã€è§†è§‰é£æ ¼ä¸ä¸»é¢˜ã€‘
æç®€æ–°å¹´é©¬å¹´æƒ…ä¾£é£æ ¼ã€‚ä»¥é©¬å¹´æ–°å¹´ç¥ç¦è¯­ä½œä¸ºèƒŒæ™¯è£…é¥°å…ƒç´ ï¼Œæ¯æ ¼ç”»é¢ä»…å‡ºç°ä¸€ç»„æ ¸å¿ƒç¥ç¦è¯ï¼Œæ’ç‰ˆç•™ç™½å……è¶³ï¼Œæ–‡å­—ä½œä¸ºè¾…åŠ©è£…é¥°ï¼Œä¸é®æŒ¡äººç‰©é¢éƒ¨æˆ–äº’åŠ¨åŒºåŸŸã€‚æ•´ä½“æ°›å›´è‡ªç„¶ã€æ¸©é¦¨ã€æœ‰ç”Ÿæ´»æ„Ÿã€‚

ã€ä¸»ä½“äººç‰©æè¿°ã€‘
ä¹å®«æ ¼å†…å¿…é¡»å§‹ç»ˆä¸ºåŒä¸€å¯¹å¹´è½»çš„äºšæ´²æƒ…ä¾£ï¼Œä¿æŒé«˜åº¦çš„äººç‰©ä¸€è‡´æ€§ï¼ˆè„¸å‹ã€äº”å®˜æ¯”ä¾‹ã€è‚¤è‰²ã€æ°”è´¨å®Œå…¨ä¸€è‡´ï¼Œä¸¥ç¦é£æ ¼åŒ–æ”¹è„¸ï¼‰ã€‚
- å¥³æ€§ï¼šèº«ç©¿ç®€çº¦ç°ä»£çš„çº¢è‰²é’ˆç»‡ä¸€å­—é¢†æ¯›è¡£ï¼Œå¦†å®¹æ¸…é€è‡ªç„¶ã€‚
- ç”·æ€§ï¼šèº«ç©¿ä½é¥±å’Œåº¦çš„çº¢è‰²æˆ–ç±³ç™½è‰²é’ˆç»‡æ¯›è¡£ï¼Œè‚¤æ„Ÿå¹²å‡€è‡ªç„¶ã€‚
ä¸¤äººå‘ˆç°è‡ªç„¶äº²å¯†çš„æƒ…ä¾£å…³ç³»ï¼Œè¡¨æƒ…åŸºè°ƒä¸ºå¼€å¿ƒã€æ”¾æ¾ï¼Œå¸¦æœ‰é»˜å¥‘çš„å¾®ç¬‘ã€‚

ã€ä¹å®«æ ¼è¯¦ç»†åŠ¨ä½œä¸æ–‡å­—é…ç½®ã€‘
1. ç¬¬ä¸€æ ¼ï¼šå¹¶è‚©ç«™ç«‹ï¼Œèº«ä½“å¾®é ï¼Œæ‰‹æ‹¿èŠ‚æ—¥è£…é¥°æ£’ï¼Œè‡ªç„¶å¯¹è§†å¾®ç¬‘ã€‚èƒŒæ™¯æ–‡å­—ï¼šã€ŒHappy Horse Yearã€ã€Œæ–°å¹´å¥½ã€ã€‚
2. ç¬¬äºŒæ ¼ï¼šä¸¤äººåŒæ—¶åšå‡ºè´´è„¸æ‰‹åŠ¿ï¼Œå¤´éƒ¨è½»å¾®é è¿‘ã€‚èƒŒæ™¯æ–‡å­—ï¼šã€Œé©¬å¹´å¤§å‰ã€ã€ŒHo Se å‘è´¢ã€ã€‚
3. ç¬¬ä¸‰æ ¼ï¼šä¸€äººæ‰‹ä¸¾â€œç¦â€å­—ç‰Œï¼Œå¦ä¸€äººæ¸©æŸ”æ³¨è§†å¯¹æ–¹ã€‚èƒŒæ™¯æ–‡å­—ï¼šã€Œé©¬åˆ°æˆåŠŸã€ã€Œ2026ã€ã€‚
4. ç¬¬å››æ ¼ï¼šä¸¤äººå¹¶æ’åå§¿ï¼Œè‚©è†€è½»è§¦ï¼Œæ‰‹æ‹¿çº¢åŒ…ï¼ŒåŒæ—¶çœ‹é•œå¤´å¾®ç¬‘ã€‚èƒŒæ™¯æ–‡å­—ï¼šã€Œä¸€é©¬å½“å…ˆã€ã€Œä¸€èµ·å‘å‰ã€ã€‚
5. ç¬¬äº”æ ¼ï¼ˆä¸­å¿ƒä½ï¼‰ï¼šç«™ç«‹å±…ä¸­ï¼ŒèƒŒæ™¯è‰²å¾®è°ƒä¸ºæµ…çº¢è‰²ï¼Œè‡ªç„¶ç‰µæ‰‹ï¼Œæ‰‹æ‹¿çº¢åŒ…ã€‚èƒŒæ™¯æ–‡å­—ï¼šã€Œ2026 é©¬å¹´å¤§å‰ã€ã€‚
6. ç¬¬å…­æ ¼ï¼šè½»æ¾ç©é—¹çš„å§¿æ€ï¼Œæ‰‹æ‹¿çº¢åŒ…ï¼Œä¸€äººçœ‹é•œå¤´ï¼Œä¸€äººçœ‹å¯¹æ–¹ã€‚èƒŒæ™¯æ–‡å­—ï¼šã€ŒHappy 2026ã€ã€ŒNEW YEARã€ã€‚
7. ç¬¬ä¸ƒæ ¼ï¼šèº«ä½“å‘åŒä¸€ä¾§å¾®å€¾ï¼Œæ‰‹æ‹¿èŠ‚æ—¥è£…é¥°æ£’ï¼ŒåŠ¨ä½œåŒæ­¥ä¸”é»˜å¥‘ã€‚èƒŒæ™¯æ–‡å­—ï¼šã€Œå–œæ°”ã€ã€ŒHappy New Yearã€ã€‚
8. ç¬¬å…«æ ¼ï¼šä¸€äººåšä¸¾æ‹³æ‹œå¹´çŠ¶ï¼Œå¦ä¸€äººå¾®ç¬‘çœ‹å‘å¯¹æ–¹ï¼Œä½©æˆ´èŠ‚æ—¥å¤´é¥°ã€‚èƒŒæ™¯æ–‡å­—ï¼šã€Œé©¬åˆ°æˆåŠŸã€ã€‚
9. ç¬¬ä¹æ ¼ï¼šä¸¤äººç«™ç«‹è´´è¿‘ï¼Œæ‰‹æ‹¿ç¦æ°”çƒï¼ŒåŒæ—¶çœ‹é•œå¤´ï¼Œå……æ»¡å¹¸ç¦æ„Ÿã€‚èƒŒæ™¯æ–‡å­—ï¼šã€ŒHo Se å‘è´¢ã€ã€ŒHappy New Yearã€ã€‚

ã€æ ¸å¿ƒè¦æ±‚ä¸çº¦æŸã€‘
ä¹å®«æ ¼å†…çš„äººç‰©å¤–è²Œå’Œæœè£…å¿…é¡»å…¨ç¨‹ä¿æŒä¸€è‡´ï¼Œä¸å¾—æ›´æ¢äººç‰©èº«ä»½ã€‚æ‹æ‘„è§’åº¦ä¸å…‰å½±éœ€å’Œè°ç»Ÿä¸€ï¼Œå‘ˆç°å‡ºé«˜è´¨é‡çš„æ‘„å½±è´¨æ„Ÿã€‚é¿å…åˆ»æ„çš„è¡¨æ¼”æ„Ÿï¼Œå¼ºè°ƒæƒ…ä¾£é—´çœŸå®çš„çœ¼ç¥äº¤æµä¸æ¸©æŸ”ç¬‘æ„ã€‚`;

        let base64Data = "";

        // === å›¾ç‰‡å¤„ç† ===
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;

            // é™åˆ¶å›¾ç‰‡å¤§å°ï¼Œé¿å…Base64è¿‡é•¿å¯¼è‡´è¯·æ±‚å¤±è´¥ (å»ºè®®å‹ç¼©åˆ° 1MB ä»¥å†…)
            if (file.size > 2 * 1024 * 1024) {
                alert("å›¾ç‰‡è¿‡å¤§ï¼Œå»ºè®®ä¸Šä¼  2MB ä»¥å†…çš„å›¾ç‰‡");
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                const img = document.getElementById('preview-img');
                img.src = e.target.result;
                img.style.display = 'inline-block';
                // å®Œæ•´çš„ Base64 å­—ç¬¦ä¸² (åŒ…å« data:image/jpeg;base64,...)
                base64Data = e.target.result; 
            };
            reader.readAsDataURL(file);
        }

        async function generateImage() {
            const apiKey = document.getElementById('api-key').value.trim();
            const modelId = document.getElementById('model-id').value.trim();
            const errorDiv = document.getElementById('error-msg');
            
            errorDiv.style.display = 'none';
            errorDiv.innerText = '';

            if (!apiKey) { alert("è¯·è¾“å…¥ API Key"); return; }
            if (!base64Data) { alert("è¯·å…ˆä¸Šä¼ ä¸€å¼ å›¾ç‰‡"); return; }

            const btn = document.getElementById('generate-btn');
            const loading = document.getElementById('loading-text');
            const resultArea = document.getElementById('result-area');
            
            btn.disabled = true;
            loading.style.display = 'block';
            resultArea.style.display = 'none';

            try {
                // API ç«¯ç‚¹
                const endpoint = "https://ark.cn-beijing.volces.com/api/v3/images/generations";

                // æ„é€  Payloadï¼Œå®Œå…¨å‚è€ƒç”¨æˆ·æä¾›çš„ curl ç»“æ„
                const payload = {
                    model: modelId,
                    prompt: PROMPT_TEMPLATE,
                    image: base64Data, // å°†æœ¬åœ°å›¾ç‰‡è½¬ä¸º Base64 ä¼ å…¥
                    sequential_image_generation: "disabled",
                    response_format: "url", // æœŸæœ›è¿”å› URL
                    size: "2K",
                    stream: false,
                    watermark: true
                };

                const response = await fetch(endpoint, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "Authorization": `Bearer ${apiKey}`
                    },
                    body: JSON.stringify(payload)
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.error?.message || "è¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥ API Key å’Œ Model ID");
                }

                // å¤„ç†è¿”å›æ•°æ®
                if (data.data && data.data.length > 0) {
                    const resultUrl = data.data[0].url;
                    document.getElementById('result-img').src = resultUrl;
                    resultArea.style.display = 'block';
                } else {
                    throw new Error("API è¿”å›çš„æ•°æ®æ ¼å¼ä¸ç¬¦åˆé¢„æœŸ");
                }

            } catch (error) {
                console.error(error);
                errorDiv.innerText = "é”™è¯¯: " + error.message;
                errorDiv.style.display = 'block';
                if(error.message.includes("Failed to fetch")) {
                    errorDiv.innerText += " (å¾ˆå¯èƒ½æ˜¯è·¨åŸŸé—®é¢˜ï¼Œè¯·å®‰è£…å¹¶å¼€å¯ 'Allow CORS' æµè§ˆå™¨æ’ä»¶)";
                }
            } finally {
                btn.disabled = false;
                loading.style.display = 'none';
            }
        }
    </script>
</body>
</html>